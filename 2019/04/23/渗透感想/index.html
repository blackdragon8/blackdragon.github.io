<!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>渗透感想 | Leo.Li&#39;s Blog</title>
  <meta name="author" content="Leo Li">

  
  <meta name="description" content="blog">
  

  
  <meta name="keywords" content="hacked">
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="渗透感想">
  <meta property="og:site_name" content="Leo.Li&#39;s Blog">

  
  

  
    <meta property="og:image" content="">
  

  
  <link href="/css/images/favicon.ico" rel="icon">
  

  <link rel="alternate" href="/atom.xml" title="Leo.Li&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  


  <!-- baidu webmaster push -->
  <script src="//push.zhanzhang.baidu.com/push.js"></script>

</head>
</html>

<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Leo.Li&#39;s Blog</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="/categories">分类</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/tags">标签</a></li>
    
      <li><a href="/about">关于</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2019-04-23T15:21:46.000Z"><a href="/2019/04/23/渗透感想/">2019-04-23</a></time>
      
      
  
    <h1 class="title">渗透感想</h1>
  

    </header>
    <div class="entry">
      
        <p>摘要：渗透测试<br><a id="more"></a></p>
<h1 id="一次渗透感想"><a href="#一次渗透感想" class="headerlink" title="一次渗透感想"></a>一次渗透感想</h1><h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h3><hr>
<p>&emsp;&emsp;耐心我觉得是做渗透的必备条件之一，不放过每一个细节，有怀疑的地方就要去怀疑，有想法的时候就要去验证，不做一个被框架限制的渗透测试工程师。<br>&emsp;&emsp;废话说完了，这次目标是一个庞大的网络，跨国的那种，一级域名就有不下5个，当初自己满怀信心的情绪也被这漫漫之路磨平了不少，这也让我深刻的认识到运气不是吹的。哈哈，开玩笑的。更多的是需要耐心。。。和运气。。。</p>
<h3 id="2-第一步"><a href="#2-第一步" class="headerlink" title="2.第一步"></a>2.第一步</h3><hr>
<p>&emsp;&emsp;每位渗透测试工程师都有自己的渗透思路，各有千秋，互不相让。我的第一步说出来估计不是那么实际，也是我提笔的时候才想起来的。<br>&emsp;&emsp;先说说我之前简单的渗透思路（不喜勿喷）：<br>&emsp;&emsp;1. 收集子域名：个人比较喜爱Sublist3r，个人感觉一个 -b基本70%的子域名没问题的，其他的综合一下其他工具就好，比如lijiejie的subDomainsBrute。为什么我会这么认可sublist3r这款工具？如果你去搜过收集子域名的方法，基本都集成在了sublist3r这款工具里。比如通过证书，邮箱反查，google等。。。对了，针对大型目标，还需要收集资产信息，比如母公司等信息。<br>此处应该有份工具截图- -<br>&emsp;&emsp;2. web路径、端口以及指纹的扫描：其实这一步我当初是想分开来的，但是我真正工作了一段时间后，个人还是觉得把这三个操作放在一起比较合适。我喜欢别人问我为什么。<br>&emsp;&emsp;一般访问的web服务的协议无非就是http和https，上手dirsearch对<a href="http://xxx.com、https://xxx.com扫描一波，真香，有.git泄露，有后台，回头一看网站，没任何实际功能点，想找个上传点都没有，源码泄露了一堆，就是没交互，还不全，气不气。或者域名访问不了，再看看剩下几百个子域名，心里默念@#￥%&amp;。此时千万不要立马换域名，针对无法访问的，ping一下域名再直接扫http://ip或https://ip的路径，未必每个web服务都需要域名的。收集端口信息，时不时你会发现8081、8888还会有web服务。这时候记得扫http://ip:port，会有意向不到的收获。而且这种没域名的个人感觉会多点漏洞。另外那些3306端口的就不说了。。。" target="_blank" rel="noopener">http://xxx.com、https://xxx.com扫描一波，真香，有.git泄露，有后台，回头一看网站，没任何实际功能点，想找个上传点都没有，源码泄露了一堆，就是没交互，还不全，气不气。或者域名访问不了，再看看剩下几百个子域名，心里默念@#￥%&amp;。此时千万不要立马换域名，针对无法访问的，ping一下域名再直接扫http://ip或https://ip的路径，未必每个web服务都需要域名的。收集端口信息，时不时你会发现8081、8888还会有web服务。这时候记得扫http://ip:port，会有意向不到的收获。而且这种没域名的个人感觉会多点漏洞。另外那些3306端口的就不说了。。。</a><br>&emsp;&emsp;还有个指纹识别，一些cms毕竟是开源的，路径什么的比较好认出来，如果某域名对404的页面也返回数据，到时候你的扫描器觉得扫出来一堆堆乱七八糟的路径，如果此刻你知道cms是wordpress，wp-content是不是就有了。顺便把cms该有的漏洞也过一遍。<br>&emsp;&emsp;3. 系统版本和中间件版本：中间件漏洞多了去了，推荐<a href="https://www.freebuf.com/articles/web/192063.html?from=timeline。说实话，系统漏洞很少，我也没碰见过，印象中系统版本漏洞多用于提权，比如脏牛。我为什么会把这一步放在第三步？实在是验证一个系统漏洞蛮麻烦的。有这个时间说不定一个uploads路径就getshell了呢。。。" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/192063.html?from=timeline。说实话，系统漏洞很少，我也没碰见过，印象中系统版本漏洞多用于提权，比如脏牛。我为什么会把这一步放在第三步？实在是验证一个系统漏洞蛮麻烦的。有这个时间说不定一个uploads路径就getshell了呢。。。</a><br>&emsp;&emsp;4. 测试c段以及常规web漏洞检测：正如第二步我所说的，未必每个web服务都需要域名，此时的c段中很有可能就存在某些IP也开了web服务端口，这些是你在子域名中找不到的。大的目标一般都是直接一个c段的，如果目标不大，需注意网段的问题，乱打打偏了问题很大的。。。另外就是web漏洞了，没啥好说的，我个人测web漏洞喜欢按照其功能去测相应的漏洞，友情链接？SSRF？收集个人信息？SQL注入。。。<br>&emsp;&emsp;5. 测试旁站：个人建议以上做完之后再测旁站，比如我在ipip.net上检测旁站时，你ping旁站的域名，又发现ip不一样了。。。我心里真不知道该不该测。。。但这一招对像托管服务商的域名比较有效，你的域名做的安全，不一定一个机器上其他公司的域名就安全了哦，万一托管服务商对目录没有严格的访问限制。。。。。<br>&emsp;&emsp;6. 水坑攻击：这一步需要大量的信息收集，表面的信息收集很少能收集到员工的信息，除非邮箱规律被你猜了出来。一般配合sql注入，提取了大量的员工信息，针对性的发动水坑攻击。<br>&emsp;&emsp;7. 以上都不行怎么办：持续关注目标网址，不定时进行子域名扫描，或者特定功能的网站（比如具有上传功能的）。说不定会有新上线的网站，毕竟新上线的嘛，如果没有进行过渗透测试，安全系数肯定比其他子域名低。还有就是，有些开发为了测试某功能，简单上线后忘了下线。。。亲身经历，为开发默哀。。。。。。。。<br>&emsp;&emsp;8. 真的没了。。。欢迎补充  </p>
<p>&emsp;&emsp;我个人按照上述的模板测了不少了，但是感觉灵魂中总是欠缺了点什么。经历了这段时间，感觉渗透之前的第一步还是先构思一下，目标网址会存在什么功能，这样在渗透中不至于，拿到一个域名，东点点西点点，如果时间紧凑的话，浏览一遍网页，直接找功能。不要我觉得这里有注入，一顿sqlmap操作，最后失败，如何你能更好的理解这个参数是否需要提交到数据库，这样再去尝试手注，会省不少时间。<br>&emsp;&emsp;还有个问题就是，漏扫。漏扫不知道从什么时候感觉成了渗透测试工程师的“耻辱”。。。我们一般都是手测，不用漏扫。。。可能是我的思想有问题，总觉得别人连带你和漏扫一起嘲讽了遍。哈哈。不得不说，漏扫不能成为一个渗透测试工程师的核心工具，不说他们的误报率问题，长期使用，你一旦不用漏扫了，你会怀疑自己的。问题就在于，渗透测试阶段，该不该用漏扫。<br>&emsp;&emsp;分两点讨论，第一看目标，目标是否够庞大，目标服务器的性能是否会直接受漏扫影响。怎么说呢，如果目标很庞大，一般的系统管理员很难一个个服务器这样的看日志，除非他们有指纹识别，并把这种识别应用到各个服务器，而且把相关日志单独分出来，不大可能吧。。。只要扫不down，而且目标网络足够庞大，个人还是觉得用漏扫能省事不少。并不是让你依靠漏扫，起码有漏扫的开路，你能从三百多个子域名中发现哪个子域名问题最多，可能存在扫到扫不到的漏洞就越多。针对这些你觉得问题最多的问题，再用自己的套路去渗透，是不是比你三百个域名逐个渗透实际多了呢？貌似只有awvs11可以批量扫描。当然这个不是绝对，下面提到的getshell过程就不是用的awvs，但是运气成分很大。<br>&emsp;&emsp;第二点，渗透方。足够的人力，足够的时间，避免触发报警，那当然不用漏扫哈，谁都不傻，可是呢，有些项目如果周期短，目标庞大，人手不够，你能怎么办。。。给那些鄙视漏扫的人试试最好。</p>
<h3 id="3-getshell经历"><a href="#3-getshell经历" class="headerlink" title="3.getshell经历"></a>3.getshell经历</h3><hr>
<p>未完待续</p>

      
    </div>
    
    <footer>
        <div class="alignright">
          
          <a href="javascript:void(0)" class="share-link bdsharebuttonbox" data-cmd="more">分享</a>
        </div>
        
        
  
  <div class="tags">
    <a href="/tags/WEB/">WEB</a>
  </div>

        <!-- partial('post/share') -->
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:blog.youdube.ga">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/APP/">APP</a><small>1</small></li>
  
    <li><a href="/categories/WEB/">WEB</a><small>1</small></li>
  
    <li><a href="/categories/区块链/">区块链</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2019/08/17/内部域名/">内部域名</a>
      </li>
    
      <li>
        <a href="/2019/05/07/上传总结/">上传总结</a>
      </li>
    
      <li>
        <a href="/2019/04/23/渗透感想/">渗透感想</a>
      </li>
    
      <li>
        <a href="/2019/02/10/浅析https原理以及过程/">浅析https原理以及过程</a>
      </li>
    
      <li>
        <a href="/2019/01/01/我认识的区块链/">初始区块链</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/APP/">APP</a><small>1</small></li>
  
    <li><a href="/tags/WEB/">WEB</a><small>4</small></li>
  
    <li><a href="/tags/区块链/">区块链</a><small>1</small></li>
  
  </ul>
</div>


  
</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  <p>
  
  &copy; 2019 Leo Li
  
  All rights reserved.</p>
  <p>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></p>
</div>
<div class="clearfix"></div>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


<div id="bg"></div>
</body>
</html>